<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>KOMBO æŠ€èƒ½å‡ç´šæ¨¡æ“¬å™¨ + ä¸‰é—œå°éŠæˆ²</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* ===== å…¨å±€æ¨£å¼ ===== */
    body {
      font-family: Arial, sans-serif;
      background-image: url('èƒŒæ™¯.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    .logo {
      width: 120px;
      margin: 10px auto;
      display: block;
    }
    .kcoin {
      font-size: 24px;
      color: #004080;
      margin-bottom: 10px;
    }
    .spent {
      font-size: 18px;
      color: #333;
      margin-bottom: 20px;
    }

    /* ===== é–‹å ´ Intro Modal ===== */
    #introModal {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: white;
      z-index: 9999;
      padding: 30px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: left;
    }
    #introModal h2 {
      color: #f60;
      margin-bottom: 10px;
    }
    #introModal ol {
      margin-left: 20px;
      margin-bottom: 10px;
    }
    #introModal a {
      color: #0066cc;
      font-weight: bold;
      text-decoration: underline;
    }
    #introModal button {
      background: #f60;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }

    /* ===== æŠ€èƒ½å‡ç´šå€ ===== */
    .skill-block {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 10px 0;
    }
    .skill-name {
      font-size: 18px;
      color: #004080;
      width: 30%;
      text-align: left;
    }
    .skill-level {
      font-size: 18px;
      width: 20%;
    }
    .btn-group {
      display: flex;
      gap: 5px;
      width: 50%;
      justify-content: flex-end;
    }
    /* å‡ç´šæŒ‰éˆ•ï¼šæ©˜è‰² */
    .btn.upgrade {
      background: #FF7E00;
      color: white;
      border: none;
      padding: 8px;
      border-radius: 5px;
      cursor: pointer;
      width: 50%;
      font-size: 14px;
    }
    /* é™ç´šæŒ‰éˆ•ï¼šè—è‰² */
    .btn.downgrade {
      background: #0066cc;
      color: white;
      border: none;
      padding: 8px;
      border-radius: 5px;
      cursor: pointer;
      width: 50%;
      font-size: 14px;
    }
    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    /* ===== ä¸‹æ–¹å·¥å…·æŒ‰éˆ• ===== */
    .tools {
      margin-top: 30px;
    }
    .tools button {
      margin: 0 8px;
      padding: 10px 18px;
      background: #0066cc;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }
    .orange-btn {
      background: #f60;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    .orange-title {
      color: #f60;
      font-weight: bold;
      font-size: 24px;
      margin-bottom: 12px;
    }

.orange-btn:hover {
  opacity: 0.9;
}

    /* ===== Modal æ¨è–¦å¡ç‰‡å½ˆçª— ===== */
    .modal-overlay {
      display: none; /* JS æ§åˆ¶é¡¯ç¤ºæˆ–éš±è— */
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background-color: rgba(0,0,0,0.5);
      z-index: 9998;
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      max-width: 320px;
      width: 90%;
      padding: 20px;
      text-align: center;
      position: relative;
      animation: fadeInModal 0.3s ease-out;
      color: #333;
    }
    @keyframes fadeInModal {
      from { opacity: 0; transform: translateY(-20px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .modal-content img {
      max-width: 80%;
      height: auto;
      margin-bottom: 12px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .modal-content h3 {
      color: #D35400;
      margin-bottom: 8px;
      font-size: 18px;
    }
    .modal-content p {
      margin: 6px 0;
      line-height: 1.4;
      font-size: 14px;
      color: #333;
    }
    .modal-close-btn {
      margin-top: 12px;
      padding: 8px 16px;
      background: #0066CC;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }

    /* ===== å°éŠæˆ² Modal ===== */
    #gameModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background-color: rgba(0,0,0,0.5);
      z-index: 9997;
      justify-content: center;
      align-items: center;
    }
    #gameContent {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      width: 360px;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      color: #333;
    }
    #gameContent h3 {
      margin-bottom: 12px;
      color: #D35400;
    }
    .grid-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin: 12px 0;
    }
    .grid-button {
      background: #eee;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 0;
      cursor: pointer;
      transition: background 0.2s;
      position: relative;
      height: 80px;
      overflow: hidden;
    }
    .grid-button.selected {
      outline: 3px solid #FF7E00; /* æ¨™ç¤ºå·²é¸å– */
    }
    .grid-button.correct {
      background: #c8e6c9; /* ç¶ è‰²æç¤ºå·²é¸æ­£ç¢º */
    }
    .grid-button.wrong {
      background: #ffcdd2; /* ç´…è‰²æç¤ºå·²é¸éŒ¯èª¤ */
      cursor: default;
    }
    .grid-button img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    #confirmBtn {
      margin-top: 10px;
      padding: 8px 16px;
      background: #FF7E00;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }
    #confirmBtn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    #gameStatus {
      font-size: 16px;
      margin-top: 12px;
    }
    #followButtons {
      margin-top: 10px;
      display: none; /* åªæœ‰ä¸‰é—œéƒ½ç­”å®Œæ‰é¡¯ç¤º */
    }
    #followButtons button {
      margin: 4px;
      padding: 6px 12px;
      background: #0066CC;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #exitGameBtn {
      margin-top: 16px;
      padding: 6px 12px;
      background: #666;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    /* ===== ä¸‹æ–¹æ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„å¡ç‰‡ï¼šFlex å®¹å™¨ ===== */
    .product-recommend {
      margin-top: 40px;
      display: flex;
      flex-wrap: wrap;           /* è¶…å‡ºå¯¬åº¦æ™‚è‡ªå‹•æ›è¡Œ */
      justify-content: center;   /* å¡ç‰‡ç½®ä¸­å°é½Š */
      gap: 16px;                 /* å¡ç‰‡ä¹‹é–“çš„é–“è· */
      padding: 0 10px;
      box-sizing: border-box;
    }

    /* ===== å–®å¼µç”¢å“å¡ç‰‡æ¨£å¼ ===== */
    .product {
      background-color: #FFF8E1;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 15px;
      margin: 0;                    /* äº¤ç”±çˆ¶å®¹å™¨çš„ gap æ±ºå®šé–“è· */
      max-width: 300px;             /* å¡ç‰‡æœ€å¤§å¯¬åº¦ */
      width: 100%;                  /* åœ¨ Flex ä¸‹æœƒæ ¹æ“šçˆ¶å®¹å™¨ç©ºé–“èª¿æ•´ */
      flex: 1 1 280px;              /* æœ€å° 280px å¯¬åº¦ï¼Œç•«é¢å¯¬åº¦è¶³å¤ æ™‚å¯æ”¾å¤§ */
      text-align: center;
      animation: fadeIn 0.4s ease-out;
      color: #333;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .product img {
      display: block;
      margin: 0 auto 12px;
      max-width: 80%;
      height: auto;
      border-radius: 8px;
    }
    .product h3 {
      color: #D35400;
      margin-bottom: 8px;
      font-size: 18px;
    }
    .product p {
      margin: 6px 0;
      line-height: 1.4;
      font-size: 14px;
      color: #333;
    }
    .product a {
      display: inline-block;
      margin-top: 10px;
      padding: 10px 18px;
      background: linear-gradient(90deg, #FF7E00, #D35400);
      color: #fff;
      border: none;
      border-radius: 6px;
      text-decoration: none;
      font-size: 15px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.15);
      transition: opacity 0.2s;
    }
    .product a:hover {
      opacity: 0.9;
    }
    .center-text {
      text-align: center;
    }
    .ig-share-btn {
      background: linear-gradient(45deg, #f58529, #dd2a7b, #8134af);
      color: white;
      padding: 10px 18px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }

    @media screen and (max-width: 480px) {
      #cardArea {
        transform: scale(0.8);
        transform-origin: top center;
      }
    }

  </style>
</head>
<body>
  <!-- ===== ç¬¬ä¸€å±¤ modalï¼šé–‹å§‹éŠæˆ²æé†’ ===== -->
  <div id="introModal">
    <div style="max-width:500px">
      <h2 class="center-text">ğŸ® KOMBO æ…·æŸé«”è‚² ğŸ®</h2>
      <p><strong>éŠç©å‰çš„æ³¨æ„äº‹é …ï¼š</strong></p>
      <ol style="margin-left:20px;">
        <li>æ­¤è©•åˆ†ç³»çµ±åƒ…ä¾›åƒè€ƒï¼Œç‚º KOMBO å…§éƒ¨çµ±è¨ˆè³‡æ–™ï¼Œä¸ä»£è¡¨æ¯ä½çƒå‹çš„å¯¦éš›ä½¿ç”¨æ„Ÿå—ï¼Œè«‹å¸¶è‘—<strong>è¼•é¬†çš„å¿ƒæƒ…éŠç©</strong>ï¼</li>
        <li>æ‰€æœ‰åƒ¹æ ¼ç‚º <strong>2025.6.11</strong> çµ±è¨ˆä¹‹çµæœï¼Œè‹¥æœªä¾†æ¯›ç‰‡æˆæœ¬æœ‰èª¿æ•´ï¼Œæ‰€æœ‰é‡‘é¡çš†æœƒæœ‰æ‰€è®Šå‹•ã€‚è‹¥å°ç·¨ä¾†ä¸åŠæ›´æ–°ï¼Œé‚„è«‹å¤§å®¶è¦‹è«’ï¼</li>
      </ol>
      <p class="center-text">ğŸ“© å°ç·¨ä¸æ˜¯æœ¬ç§‘ç”Ÿè‹¥æœ‰ä»»ä½•å»ºè­°éƒ½æ­¡è¿  
        <a href="https://lin.ee/syEA7iU" target="_blank">
          å®˜æ–¹Line
        </a> ç§è¨Šæˆ‘å€‘å–”ï¼
      </p>
      <div style="text-align:center; margin-top:20px;">
        <button onclick="showRuleModal()">åŒæ„</button>
      </div>
    </div>
  </div>

  <!-- ===== ç¬¬äºŒå±¤ modalï¼šé–‹å§‹éŠæˆ²æé†’ ===== -->
  <div id="ruleModal" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: white; z-index: 9998; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: left;">
    <div style="max-width: 500px;">
      <h2 class="orange-title center-text">ğŸ”¥ å‰µé€ å±¬æ–¼ä½ çš„ç¾½æ¯›çƒ ğŸ”¥</h2>
      <p><strong>éŠæˆ²ä»‹ç´¹ï¼š</strong></p>
      <ol style="margin-left: 20px;">
        <li>ç›®å‰å·²ç¶“èŠ±è²»äº†$450Kå¹£ï¼Œåªç²å¾—Lv.1çš„ç¾½æ¯›çƒï¼ŒéŠç©å°éŠæˆ²ä¾†ç²å–æ›´å¤šKå¹£ï¼Œæå‡ä½ çš„ç¾½æ¯›çƒæŠ€èƒ½å§!</li>
      </ol>
      <p class="center-text" style="font-weight: bold; font-size: 18px;">
      é€™æ˜¯ä¸€å ´æŠ€èƒ½çš„è©¦ç…‰â€”â€”å‡ºç™¼å§ï¼ŒK å¤§å¸«ï¼
      </p>
    
    <div style="text-align: center; margin-top: 20px;">
      <button class="orange-btn" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
    </div>
  </div>
</div>
  <!-- ===== LOGO & å·²èŠ±è²»/å‰©é¤˜ K å¹£ ===== -->
  <img src="LOGO.jpg" class="logo" alt="KOMBO Logo">
  <div class="spent">å·²èŠ±è²» K å¹£ï¼š<span id="spent">450</span> å…ƒ</div>
  <div class="kcoin">å‰©é¤˜ K å¹£ï¼š<span id="kcoin">0</span> å…ƒ</div>

  <!-- ===== æŠ€èƒ½å€ ===== -->
  <div class="skill-block">
    <div class="skill-name">æ‰‹æ„Ÿ</div>
    <div class="skill-level" id="lv-touch">Lv.1</div>
    <div class="btn-group">
      <button class="btn upgrade" id="up-touch" onclick="upgrade('touch')" disabled>å‡ç´šï¼ˆ+10 å…ƒï¼‰</button>
      <button class="btn downgrade" id="down-touch" onclick="downgrade('touch')" disabled>é™ç´šï¼ˆ-10 å…ƒï¼‰</button>
    </div>
  </div>
  <div class="skill-block">
    <div class="skill-name">è€æ‰“</div>
    <div class="skill-level" id="lv-durability">Lv.1</div>
    <div class="btn-group">
      <button class="btn upgrade" id="up-durability" onclick="upgrade('durability')" disabled>å‡ç´šï¼ˆ+10 å…ƒï¼‰</button>
      <button class="btn downgrade" id="down-durability" onclick="downgrade('durability')" disabled>é™ç´šï¼ˆ-10 å…ƒï¼‰</button>
    </div>
  </div>
  <div class="skill-block">
    <div class="skill-name">é£›è¡Œ</div>
    <div class="skill-level" id="lv-flight">Lv.1</div>
    <div class="btn-group">
      <button class="btn upgrade" id="up-flight" onclick="upgrade('flight')" disabled>å‡ç´šï¼ˆ+10 å…ƒï¼‰</button>
      <button class="btn downgrade" id="down-flight" onclick="downgrade('flight')" disabled>é™ç´šï¼ˆ-10 å…ƒï¼‰</button>
    </div>
  </div>
  <div class="skill-block">
    <div class="skill-name">å¤–è§€</div>
    <div class="skill-level" id="lv-look">Lv.1</div>
    <div class="btn-group">
      <button class="btn upgrade" id="up-look" onclick="upgrade('look')" disabled>å‡ç´šï¼ˆ+10 å…ƒï¼‰</button>
      <button class="btn downgrade" id="down-look" onclick="downgrade('look')" disabled>é™ç´šï¼ˆ-10 å…ƒï¼‰</button>
    </div>
  </div>

  <!-- ===== å·¥å…·æŒ‰éˆ• ===== -->
  <div class="tools">
    <button onclick="openGame()">â–¶ ç©éŠæˆ²è³º K å¹£ï¼ˆä¸‰é—œï¼‰</button>
    <button onclick="resetAll()">ğŸ”„ é‡ç½®</button>
    <button class="ig-share-btn" onclick="shareToInstagram()">ğŸ“¤ åˆ†äº«æŠ€èƒ½å¡åˆ° IG
    </button>
  </div>


  <!-- ===== ç”¢ç”ŸæŠ€èƒ½å¡å€ ===== -->
  <div id="skillCardSection" style="margin-top: 40px;">
    <h2 class="orange-title">ğŸ§© å°ˆå±¬æŠ€èƒ½å¡</h2>
    <div style="margin-bottom: 10px;">
      <label>åå­—ï¼š<input type="text" id="playerName" placeholder="è¼¸å…¥åå­—"></label>
    </div>
    <div style="margin-bottom: 10px;">
      <label style="display: none;">é¸æ“‡ç¾½çƒç­’é¡è‰²ï¼š
  <input type="color" id="tubeColor" value="#000000">
</label>
    </div>
    <div style="margin-bottom: 10px;">
      <label>æŠ€èƒ½æ¢é¡è‰²ï¼š<input type="color" id="barColor" value="#0A574F"></label>
    </div>
    <button class="orange-btn" onclick="generateSkillCard()">ç”¢ç”ŸæŠ€èƒ½å¡</button>
    <button class="tools" onclick="downloadSkillCard()">ä¸‹è¼‰æŠ€èƒ½å¡</button>
    <div id="cardPreview" style="margin-top: 20px;"></div>
  </div>

  <script>
 function generateSkillCard() {
  const name = document.getElementById('playerName').value || 'XXXXXXXX';
  const tubeColor = document.getElementById('tubeColor').value;
  const barColor = document.getElementById('barColor').value;
  const lv2width = lv => ((lv - 1) * 20 + 20) + '%';

  const html = `
    <div id="cardArea" style="
      position: relative;
      width: 320px;
      aspect-ratio: 2/3;
      background: url('ç¾½çƒæŠ€èƒ½å¡èƒŒæ™¯.png') no-repeat center center;
      background-size: contain;
      font-family: sans-serif;
      margin: auto;
      padding: 0;
      box-sizing: border-box;
    ">
      <!-- åå­— -->
      <div style="
        position: absolute;
        top: 36px;
        width: 100%;
        text-align: center;
        font-weight: bold;
        font-size: 28px;
      ">${name}</div>

      <!-- æ¨™é¡Œ -->
      <div style="
        position: absolute;
        top: 78px;
        width: 100%;
        text-align: center;
        font-size: 20px;
      ">ç¾½çƒæŠ€èƒ½å¡</div>

      <!-- ç¾½çƒç­’é¡è‰²æ–¹å¡Š -->
      <div style="
        display: none;
        position: absolute;
        top: 152px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 100px;
        background: ${tubeColor};
        border-radius: 5px;
      "></div>

      <!-- æŠ€èƒ½æ¢ -->
      <div style="
        position: absolute;
        top: 282px;
        left: 40px;
        right: 45px;
        font-size: 14px;
        line-height: 26px;
        text-align: left;
      ">
        <div>æ‰‹æ„Ÿ</div>
        <div style="background: #ccc; height: 10px; border-radius: 4px; margin-bottom: 1.5px;">
          <div style="background: ${barColor}; width: ${lv2width(skills.touch)}; height: 100%; border-radius: 4px;"></div>
        </div>

        <div>è€æ‰“</div>
        <div style="background: #ccc; height: 10px; border-radius: 4px; margin-bottom: 1.5px;">
          <div style="background: ${barColor}; width: ${lv2width(skills.durability)}; height: 100%; border-radius: 4px;"></div>
        </div>

        <div>é£›è¡Œ</div>
        <div style="background: #ccc; height: 10px; border-radius: 4px; margin-bottom: 1.5px;">
          <div style="background: ${barColor}; width: ${lv2width(skills.flight)}; height: 100%; border-radius: 4px;"></div>
        </div>

        <div>å¤–è§€</div>
        <div style="background: #ccc; height: 10px; border-radius: 4px; margin-bottom: 2.5px;">
          <div style="background: ${barColor}; width: ${lv2width(skills.look)}; height: 100%; border-radius: 4px;"></div>
        </div>

        <div style="font-weight:bold;">å”®åƒ¹ï¼š$${spent} å…ƒ</div>
      </div>
    </div>
  `;

  document.getElementById('cardPreview').innerHTML = html;
}

  </script>

  <script>
  function downloadSkillCard() {
    html2canvas(document.getElementById('cardArea'), {
      scale: 4 // è®“ä¸‹è¼‰æ™‚ç•«è³ªé«˜ï¼ˆ3200x4800ï¼‰
    }).then(canvas => {
      const link = document.createElement('a');
      link.download = 'KOMBO_æŠ€èƒ½å¡.png';
      link.href = canvas.toDataURL();
      link.click();
    });
  }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<!-- é ˆå¼•å…¥ html2canvas å¥—ä»¶ï¼ˆæ”¾åœ¨ body çµå°¾è™•ï¼‰ -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <!-- ===== æ¨è–¦å½ˆçª— ===== -->
  <div class="modal-overlay" id="recommendModal">
    <div class="modal-content" id="modalContent">
      <h3>ğŸ¯ é©åˆæ‚¨çš„çƒï¼š<span id="modalName"></span></h3>
      <img id="modalImg" src="" alt="ç”¢å“åœ–">
      <p id="modalDesc"></p>
      <p><strong>å”®åƒ¹ï¼š</strong>$<span id="modalPrice"></span>/ç­’</p>
      <p>
        æ‰‹æ„Ÿ Lv.<span id="modalTouch"></span> ï½œ 
        è€æ‰“ Lv.<span id="modalDurability"></span> ï½œ 
        é£›è¡Œ Lv.<span id="modalFlight"></span> ï½œ 
        å¤–è§€ Lv.<span id="modalLook"></span>
      </p>
      <button class="modal-close-btn" id="closeModalBtn">é—œé–‰</button>
    </div>
  </div>

  <!-- ===== å°éŠæˆ²å½ˆçª—ï¼ˆå…±ä¸‰é—œï¼‰ ===== -->
  <div id="gameModal">
    <div id="gameContent">
      <h3 id="gameTitle">é—œå¡ 1ï¼šé¸å‡º KOMBO ç”¢å“ ï¼ˆé‚„å‰© <span id="needCount">5</span> å€‹ï¼‰</h3>
      <div class="grid-container" id="gridContainer">
        <!-- JS æœƒå‹•æ…‹æ’å…¥ 3Ã—3 çš„æŒ‰éˆ•ï¼ˆåœ–ç‰‡ï¼‰ -->
      </div>
      <button id="confirmBtn" onclick="confirmSelection()" disabled>ç¢ºå®š</button>
      <p id="gameStatus"></p>
      <div id="followButtons">
        <p>æ­å–œå®Œæˆä¸‰é—œï¼é‚„å¯é¡å¤–åŠ ç¢¼ï¼š</p>
        <button id="igBtn" onclick="followIG()">è¿½è¹¤ IGï¼ˆ+50 å…ƒï¼‰</button>
        <button id="fbBtn" onclick="followFB()">æŒ‰è®š FBï¼ˆ+50 å…ƒï¼‰</button>
      </div>
      <button id="exitGameBtn">âœ• é›¢é–‹éŠæˆ²</button>
    </div>
  </div>

  <!-- ===== ä¸‹æ–¹ç”¢å“å¡ç‰‡å€ ===== -->
  <div class="product-recommend" id="productDisplay">
    <!-- JS æœƒæŠŠæ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„ <div class="product">â€¦</div> å‹•æ…‹æ’å…¥åˆ°é€™è£¡ -->
  </div>

  <!-- ===== é»æ“ŠéŸ³æ•ˆ ===== -->
  <audio id="clickSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_f7998b6be6.mp3?filename=click-124467.mp3"></audio>

  <script>
    // ============== å…¨å±€ç‹€æ…‹ ==============
    let kcoin = 0;                     // å‰©é¤˜ K å¹£ï¼Œä¸€é–‹å§‹ç‚º 0
    let spent = 450;                   // å·²èŠ±è²» K å¹£ï¼Œä¸€é–‹å§‹ç‚º 450
    const maxLevel = 5;
    const skills = { touch: 1, durability: 1, flight: 1, look: 1 };
    const displayLv = {
      touch: document.getElementById("lv-touch"),
      durability: document.getElementById("lv-durability"),
      flight: document.getElementById("lv-flight"),
      look: document.getElementById("lv-look")
    };

    let soundOn = true;
    let hasShownModalFor = new Set();  // ç´€éŒ„å·²ç¶“å½ˆéæ¨è–¦ Modal çš„ç”¢å“

    // ===== ç”¢å“åˆ—è¡¨ï¼ˆç”±é«˜åƒ¹åˆ°ä½åƒ¹æ’åºï¼‰ =====
    const products = [
      {
        name: "K3A",
        price: 720,
        touch: 5,
        durability: 5,
        flight: 5,
        look: 4,
        image: "K3A.jpg",
        desc: "ä½¿ç”¨ä¸‰ã€å››ç´šéµæ¯›ï¼Œéµæ¯›æ¯›æ¡¿è¼ƒç‚ºç´°é•·ï¼Œå¤§æ¯›ä¸­çš„æ–¹é ­æ¯›å§‹æ–¼éŸŒæ€§é«˜ä¸”çµå¯¦ï¼æ­é…ä¸Šç‰¹èª¿çš„é«˜å›å¾©æ€§è† æ°´ï¼Œè®“çƒä¸å› æ‰“æ“Šè€Œé¬†æ•£ï¼",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K3",
        price: 720,
        touch: 5,
        durability: 5,
        flight: 4.5,
        look: 4.5,
        image: "K3.jpg",
        desc: "é¸ç”¨ä¸€ã€äºŒç´šåˆºéª¨é´¨æ½”ç™½æ¯›ç‰‡ï¼Œç‰¹é¸çš„éƒ¨ä½ï¼Œç‰¹é¸è† æ°´ï¼Œä½¿è€æ‰“åº¦æ›´ä¸Šä¸€éšï¼ŒåŒæ™‚å°‡çƒé ­çš„å¯†åº¦æå‡ï¼Œä½¿æ‰‹æ„Ÿæ›´åŠ æ‰å¯¦ï¼Œé£›è¡Œæ›´åŠ ç©©å®šã€‚",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K5+",
        price: 635,
        touch: 4,
        durability: 4,
        flight: 4,
        look: 4,
        image: "K5+.jpg",
        desc: "é¸ç”¨æ­£ä¸‰ç´šçš„åˆºéª¨é´¨ï¼Œç›¸è¼ƒæ–¼ä¸€äºŒç´šæ¯›ç‰‡è¼ƒé»ƒï¼Œç•¥æœ‰ç´°å¾®ç‘•ç–µï¼Œæ•´é«”å…¼å…·è€ç”¨è¡¨ç¾èˆ‡è¦ªæ°‘åƒ¹æ ¼ã€‚",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K5A",
        price: 630,
        touch: 4,
        durability: 4,
        flight: 3.5,
        look: 3,
        image: "K5A.jpg",
        desc: "ä½¿ç”¨å››ã€äº”ç´šéµæ¯›ï¼Œä»é¸ç”¨ç‰¹å®šçš„éƒ¨ä½ï¼Œè®“è³ªé‡èƒ½é”åˆ°ä¸€å®šçš„æ°´æº–ï¼Œæ­é…ä¸Šé«˜å½ˆæ€§çš„è† æ°´ï¼Œä½¿é£›è¡Œç©©å®šåˆå…¼é¡§å¥½çš„æ‰‹æ„Ÿï¼",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K5",
        price: 595,
        touch: 4,
        durability: 3.5,
        flight: 3.5,
        look: 3,
        image: "K5.jpg",
        desc: "é¸ç”¨æ¯›æ¡¿Qå½ˆã€ç¾½ç¿¼åšå¯¦çš„ä¸‰ã€å››ç´šåˆºéª¨é´¨ï¼Œæ­é…ç‰¹èª¿è† æ°´ï¼Œä½¿æ‰‹æ„Ÿèˆ’é©ä¸ç”Ÿç¡¬ï¼Œæ›´ä¸å®¹æ˜“æ–·æ¯›å¥½æ§åˆ¶ï¼Œç©©å®šé£›è¡Œï¼Œæ˜¯é«˜æ€§åƒ¹æ¯”çš„é¦–é¸ã€‚",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "KC",
        price: 560,
        touch: 4,
        durability: 3,
        flight: 4,
        look: 2,
        image: "KC.jpg",
        desc: "ä½¿ç”¨å¤©ç„¶äº”ç´šéµæ¯›ï¼Œé›–ç„¶æ¯›è‰²çš„æ•´æ½”åº¦ä¸æ˜¯ç²¾é¸ï¼Œä½†å…·æœ‰æ­£å¸¸éµæ¯›çš„ç©©å®šæ€§èˆ‡è€æ‰“åº¦ï¼Œæ­é…ä¸Šè¤‡åˆå¼è† æ°´ï¼Œæ‰“æ„Ÿèˆ’é©ï¼Œå¥½æ§çƒã€‚",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K7pro",
        price: 480,
        touch: 2,
        durability: 4,
        flight: 2,
        look: 2,
        image: "K7PRO.jpg",
        desc: "ä½¿ç”¨ä¸€ã€äºŒç´šéµå¤§åˆ€ï¼Œè‹¥èƒ½æ¥å—é£›è¡Œæ²’é‚£éº¼ç©©å®šçš„è©±ï¼Œå¯ä»¥è©¦è©¦é€™æ¬¾çƒã€‚",
        link: "https://lin.ee/syEA7iU"
      }
    ];

    // ============== éŸ³æ•ˆæ’­æ”¾ ==============
    function playSound() {
      if (soundOn) {
        document.getElementById("clickSound").play();
      }
    }

    // ============== å‡ç´šï¼é™ç´š ==============
    function upgrade(skill) {
      // åªè¦ç©å®¶å‰©é¤˜ K å¹£ â‰¥ 10ã€ä¸”æŠ€èƒ½å°šæœªæ»¿ï¼Œå°±å¯ä»¥å‡ 0.5 ç´šï¼Œä¸¦æ‰£ 10 å…ƒï¼Œspent åŠ  10
      if (skills[skill] < maxLevel && kcoin >= 10) {
        skills[skill] += 0.5;
        kcoin -= 10;
        spent += 10;
        playSound();
        updateDisplay(skill);
        saveState();
      }
    }
    function downgrade(skill) {
      // å¦‚æœè©²æŠ€èƒ½å¤§æ–¼ Lv.1ï¼Œå°±å¯é™ 0.5 ç´šï¼Œä¸¦é€€ 10 å…ƒåˆ°å‰©é¤˜ K å¹£ï¼Œspent æ¸› 10
      if (skills[skill] > 1) {
        skills[skill] -= 0.5;
        kcoin += 10;
        spent -= 10;
        playSound();
        updateDisplay(skill);
        saveState();
      }
    }

    // ============== æ›´æ–°ç•«é¢é¡¯ç¤º ==============
    function updateDisplay(skill) {
      // æ›´æ–°å‰©é¤˜èˆ‡å·²èŠ±è²» K å¹£
      document.getElementById("kcoin").textContent = kcoin;
      document.getElementById("spent").textContent = spent;

      // æ›´æ–°å–®ä¸€æŠ€èƒ½çš„ç­‰ç´šæ–‡å­—
      displayLv[skill].textContent = (skills[skill] >= maxLevel) ? "å·²æ»¿ç­‰" : ("Lv." + skills[skill]);

      // å‡ç´š/é™ç´šæŒ‰éˆ•æ˜¯å¦å¯ç”¨
      document.getElementById("up-" + skill).disabled = (skills[skill] >= maxLevel || kcoin < 10);
      document.getElementById("down-" + skill).disabled = (skills[skill] <= 1);

      // æ¯æ¬¡æ›´æ–°éƒ½å˜—è©¦è§¸ç™¼æ¨è–¦ Modal æˆ–æ¸²æŸ“ä¸‹æ–¹å¡ç‰‡
      checkProductMatch();
    }

    // ============== åˆ†äº«è‡³ Instagramï¼ˆæˆ–è¤‡è£½è‡³å‰ªè²¼ç°¿ï¼‰ ==============
    function shareToInstagram() {
      const card = document.getElementById('cardArea');
      if (!card) {
        alert("è«‹å…ˆé»é¸ã€Œç”¢ç”ŸæŠ€èƒ½å¡ã€å†åˆ†äº«ï¼");
        return;
      }

      html2canvas(card, { scale: 4 }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'KOMBO_æŠ€èƒ½å¡.png';
        link.href = canvas.toDataURL();
        link.click();

        // é¡¯ç¤ºæé†’
        alert("å·²è‡ªå‹•ä¸‹è¼‰æŠ€èƒ½å¡åˆ°ç›¸ç°¿ğŸ“¸\n\nç”±æ–¼å°ç·¨èƒ½åŠ›æœ‰é™ï¼Œç„¡æ³•ç›´æ¥é–‹å•Ÿ IGï¼Œè«‹æ‚¨æ‰‹å‹•æ‰“é–‹ Instagramï¼Œä¸¦é¸æ“‡å‰›å‰›ä¸‹è¼‰çš„åœ–ç‰‡ä¸Šå‚³åˆ†äº«ï¼Œè¬è¬æ‚¨ ğŸ§¡");
      });
    }

    // ============== é‡æ–°è¨­å®š & å­˜ / è¼‰ æœ¬åœ°åŒ–ç‹€æ…‹ ==============
    function saveState() {
      localStorage.setItem("kombo_skills", JSON.stringify({ kcoin, spent, skills }));
    }
    function loadSaved() {
      // æ¸…ç©º localStorageï¼Œå›åˆ°åˆå§‹ç‹€æ…‹ï¼šK å¹£ 0ï¼Œå·²èŠ±è²» 450ï¼ŒæŠ€èƒ½ Lv.1
      localStorage.removeItem("kombo_skills");
      kcoin = 0;
      spent = 450;
      skills.touch = skills.durability = skills.flight = skills.look = 1;
      for (let key in skills) {
        displayLv[key].textContent = "Lv.1";
        document.getElementById("up-" + key).disabled = true;
        document.getElementById("down-" + key).disabled = true;
      }
      document.getElementById("kcoin").textContent = kcoin;
      document.getElementById("spent").textContent = spent;
      hasShownModalFor.clear();
      renderAllMatchingCards();
    }

    // â–¶ **é‡ç½®æŒ‰éˆ•**ï¼šå‘¼å« loadSaved()ï¼Œä¸¦é—œé–‰æ‰€æœ‰ Modal
    function resetAll() {
      // å°‡ spent é€€é‚„çµ¦ kcoin
      kcoin += spent-450;
      spent = 450;

      // é‡è¨­æŠ€èƒ½ç‚º Lv.1
      skills.touch = skills.durability = skills.flight = skills.look = 1;

      // æ›´æ–°ç•«é¢
      for (let key in skills) {
        displayLv[key].textContent = "Lv.1";
      }
      document.getElementById("kcoin").textContent = kcoin;
      document.getElementById("spent").textContent = spent;

      enableUpgradeButtons();  // é‡æ–°å•Ÿç”¨æŒ‰éˆ•
      checkProductMatch();     // é‡æ–°æª¢æŸ¥æ¨è–¦
      saveState();             // å­˜å…¥ localStorage
    }
 


    // ============== é»æ“Šã€Œé–‹å§‹éŠæˆ²ã€æŒ‰éˆ•å¾Œï¼Œéš±è— Intro å½ˆçª— ==============
    function showRuleModal() {
  // éš±è— introï¼Œé¡¯ç¤ºè¦å‰‡ modal
  document.getElementById("introModal").style.display = "none";
  document.getElementById("ruleModal").style.display = "flex";
}

function startGame() {
  // é–‹å§‹éŠæˆ²æ‰è¼‰å…¥åˆå§‹ç‹€æ…‹
  document.getElementById("ruleModal").style.display = "none";
  loadSaved();
}


    // ============== å°éŠæˆ²é‚è¼¯ï¼ˆå…± ä¸‰ é—œï¼‰ ==============
    const gameModal     = document.getElementById("gameModal");
    const gridContainer = document.getElementById("gridContainer");
    const gameTitle     = document.getElementById("gameTitle");
    const gameStatus    = document.getElementById("gameStatus");
    const confirmBtn    = document.getElementById("confirmBtn");
    const followButtons = document.getElementById("followButtons");
    const igBtn         = document.getElementById("igBtn");
    const fbBtn         = document.getElementById("fbBtn");
    const exitGameBtn   = document.getElementById("exitGameBtn");

    let currentRound = 1;       // ç¾åœ¨ç¬¬å¹¾é—œ (1~3)
    let selectedCount = 0;      // ç•¶å‰ç©å®¶å·²é¸å–çš„æ ¼å­æ•¸ (æœ€å¤š 5)
    let totalEarned = 0;        // æœ¬æ¬¡éŠæˆ²ç´¯ç©ç²å¾—å¤šå°‘ K å¹£
    let canFollowIG = true;     // åˆ¤æ–·æ˜¯å¦å·²æŒ‰é IG
    let canFollowFB = true;     // åˆ¤æ–·æ˜¯å¦å·²æŒ‰é FB

    // å„é—œçš„é¡Œç›®é¸é …ï¼ˆ9 å€‹ï¼‰ï¼Œå…¶ä¸­ 5 å€‹æ­£ç¢ºã€‚è«‹è‡ªè¡Œæ›¿æ› image è·¯å¾‘
    const roundsData = {
      1: {
        items: [
          { label: "K7pro", isCorrect: true,  image: "K7PRO.jpg" },
          { label: "Nike çƒæ‹", isCorrect: false, image: "K7PRO.jpg" },
          { label: "KC", isCorrect: true,  image: "KC.jpg" },
          { label: "Adidas çƒé‹", isCorrect: false, image: "K7PRO.jpg" },
          { label: "K5", isCorrect: true,  image: "K5.jpg" },
          { label: "Yonex çƒæ¡¿", isCorrect: false, image: "K7PRO.jpg" },
          { label: "Li-Ning é‹", isCorrect: false, image: "K7PRO.jpg" },
          { label: "K3", isCorrect: true,  image: "K3.jpg" },
          { label: "K3A", isCorrect: true,  image: "K3A.jpg" }
        ]
      },
      2: {
        items: [
          { label: "K3A", isCorrect: true,  image: "K3A.jpg" },
          { label: "Puma æœé£¾", isCorrect: false, image: "K3A.jpg" },
          { label: "Yonex ç¾½çƒ", isCorrect: false, image: "K3A.jpg" },
          { label: "KC", isCorrect: true,  image: "KC.jpg" },
          { label: "K5+", isCorrect: true,  image: "K5+.jpg" },
          { label: "Mizuno çƒé‹", isCorrect: false, image: "K3A.jpg" },
          { label: "K7pro", isCorrect: false, image: "K7PRO.jpg" },
          { label: "K3", isCorrect: true,  image: "K3.jpg" },
          { label: "Yonex çƒæ‹", isCorrect: true,  image: "K3A.jpg" }
        ]
      },
      3: {
        items: [
          { label: "K5A", isCorrect: true,  image: "K5A.jpg" },
          { label: "K5", isCorrect: true,  image: "K5.jpg" },
          { label: "Adidas çƒè¡£", isCorrect: false, image: "K3A.jpg" },
          { label: "K3", isCorrect: true,  image: "K3.jpg" },
          { label: "K3A", isCorrect: true,  image: "K3A.jpg" },
          { label: "Yonex çƒæ‹", isCorrect: false, image: "K3A.jpg" },
          { label: "KC", isCorrect: false, image: "KC.jpg" },
          { label: "Nike çƒé‹", isCorrect: false, image: "K3A.jpg" },
          { label: "Li-Ning é‹", isCorrect: true,  image: "K3A.jpg" }
        ]
      }
    };

    // æ‰“é–‹å°éŠæˆ²ï¼šåˆå§‹åŒ–ç¬¬ä¸€é—œ
    function openGame() {
      currentRound  = 1;
      totalEarned   = 0;
      canFollowIG   = true;
      canFollowFB   = true;
      igBtn.disabled = false;
      fbBtn.disabled = false;
      followButtons.style.display = "none";
      setupRound(currentRound);
      gameModal.style.display = "flex";
    }

    // è¨­å®šæŸä¸€é—œçš„é¡Œç›®
    function setupRound(roundNum) {
      const data = roundsData[roundNum];
      selectedCount = 0;
      gameStatus.textContent = "";
      confirmBtn.disabled = true; 
      gameTitle.textContent = `é—œå¡ ${roundNum}ï¼šé¸å‡º 5 å€‹ KOMBO ç”¢å“ï¼ˆå·²é¸ ${selectedCount}/5ï¼‰`;
      gridContainer.innerHTML = "";

      // å°‡ä¹å€‹é¸é …éš¨æ©Ÿæ‰“äº‚é †åºå†æ¸²æŸ“
      const arr = [...data.items];
      arr.sort(() => Math.random() - 0.5);

      arr.forEach(item => {
        const btn = document.createElement("button");
        btn.className = "grid-button";
        btn.innerHTML = `<img src="${item.image}" alt="${item.label}">`;
        btn.dataset.isCorrect = item.isCorrect;
        btn.dataset.selected = "false";
        btn.onclick = () => toggleSelect(btn, item.isCorrect);
        gridContainer.appendChild(btn);
      });
    }

    // åˆ‡æ›æŒ‰éˆ•çš„ã€Œå·²é¸å–ã€ç‹€æ…‹
    function toggleSelect(btn, isCorrect) {
      if (btn.classList.contains("correct") || btn.classList.contains("wrong")) {
        return; // å·²æ­æ›‰çš„æ ¼å­ä¸èƒ½å†é¸
      }
      const currentlySelected = btn.dataset.selected === "true";
      if (!currentlySelected && selectedCount < 5) {
        btn.classList.add("selected");
        btn.dataset.selected = "true";
        selectedCount++;
      } else if (currentlySelected) {
        btn.classList.remove("selected");
        btn.dataset.selected = "false";
        selectedCount--;
      }
      confirmBtn.disabled = (selectedCount < 5);
      gameTitle.textContent = `é—œå¡ ${currentRound}ï¼šé¸å‡º 5 å€‹ KOMBO ç”¢å“ï¼ˆå·²é¸ ${selectedCount}/5ï¼‰`;
    }

    // æŒ‰ä¸‹ã€Œç¢ºå®šã€æ‰æ­æ›‰æœ¬é—œç­”æ¡ˆä¸¦è¨ˆåˆ†
    function confirmSelection() {
      const buttons = gridContainer.querySelectorAll(".grid-button");
      let correctCountThisRound = 0;

      buttons.forEach(btn => {
        const isCorrect = (btn.dataset.isCorrect === "true");
        const isSelected = (btn.dataset.selected === "true");
        if (isCorrect) {
          // æ­£ç¢ºçš„æ ¼å­æ¨™ç¤ºç¶ è‰²
          btn.classList.add("correct");
          if (isSelected) {
            correctCountThisRound++;
          }
        } else {
          // éŒ¯èª¤çš„æ ¼å­å¦‚æœè¢«é¸åˆ°ï¼Œæ¨™ç¤ºç´…è‰²
          if (isSelected) {
            btn.classList.add("wrong");
          }
        }
        // ç„¡è«–å¦‚ä½•éƒ½ä¸èƒ½å†åˆ‡æ›
        btn.onclick = null;
      });

      const gain = correctCountThisRound * 20;
      totalEarned += gain;
      gameStatus.textContent = `æœ¬é—œä½ é¸å° ${correctCountThisRound} å€‹ï¼Œç²å¾— ${gain} å…ƒï¼`;

      // å¦‚æœä¸æ˜¯æœ€å¾Œä¸€é—œï¼Œåœ¨ 1 ç§’å¾Œè¼‰å…¥ä¸‹ä¸€é—œ
      if (currentRound < 3) {
        setTimeout(() => {
          currentRound++;
          setupRound(currentRound);
        }, 1000);
      } else {
        // ç¬¬ä¸‰é—œçµæŸå¾Œï¼Œé¡¯ç¤ºè¿½è¹¤æŒ‰éˆ•
        setTimeout(() => {
          gameStatus.textContent = `ä¸‰é—œçµæŸï¼å…±ç²å¾— ${totalEarned} å…ƒã€‚é‚„å¯è¿½è¹¤ IG/FB å„ +50 å…ƒ`;
          followButtons.style.display = "block";
        }, 1000);
      }
      confirmBtn.disabled = true;
    }

    // IG æŒ‰éˆ•ï¼šåªçµ¦ä¸€æ¬¡ +50ï¼Œä¸¦é–‹æ–°è¦–çª—åˆ°æŒ‡å®šé€£çµ
    function followIG() {
      if (!canFollowIG) return;
      canFollowIG = false;
      igBtn.disabled = true;
      totalEarned += 50;
      window.open(
        "https://www.instagram.com/kombo_2023?igsh=bGU4dGdia3F5NWM5&utm_source=qr",
        "_blank"
      );
      gameStatus.textContent = `å·²è¿½è¹¤ IGï¼é¡å¤–ç²å¾— 50 å…ƒï¼Œç¸½å…± ${totalEarned} å…ƒ`;
    }

    // FB æŒ‰éˆ•ï¼šåªçµ¦ä¸€æ¬¡ +50ï¼Œä¸¦é–‹æ–°è¦–çª—åˆ°æŒ‡å®šé€£çµ
    function followFB() {
      if (!canFollowFB) return;
      canFollowFB = false;
      fbBtn.disabled = true;
      totalEarned += 50;
      window.open(
        "https://www.facebook.com/share/19ZXhbVjJw/?mibextid=wwXIfr",
        "_blank"
      );
      gameStatus.textContent = `å·²æŒ‰è®š FBï¼é¡å¤–ç²å¾— 50 å…ƒï¼Œç¸½å…± ${totalEarned} å…ƒ`;
    }

    // é›¢é–‹/é—œé–‰å°éŠæˆ²
    exitGameBtn.addEventListener("click", () => {
      gameModal.style.display = "none";
      // å°‡éŠæˆ²æ‰€å¾—åŠ åˆ°å‰©é¤˜ K å¹£ï¼Œå†æ›´æ–°ç•«é¢
      kcoin += totalEarned;
      document.getElementById("kcoin").textContent = kcoin;
      enableUpgradeButtons();
      renderAllMatchingCards();
    });

    // åªæœ‰ç•¶ç©å®¶å‰©é¤˜ K å¹£ â‰¥ 10ã€ä¸”æŠ€èƒ½é‚„æ²’æ»¿ï¼Œæ‰è§£é–å‡ç´šæŒ‰éˆ•
    function enableUpgradeButtons() {
      for (let key in skills) {
        const upBtn = document.getElementById("up-" + key);
        const downBtn = document.getElementById("down-" + key);
        upBtn.disabled   = !(kcoin >= 10 && skills[key] < maxLevel);
        downBtn.disabled = (skills[key] <= 1);
      }
    }

    // ============== Modal æ¨è–¦å¡ç‰‡é‚è¼¯ ==============
    const modalOverlay    = document.getElementById("recommendModal");
    const modalName       = document.getElementById("modalName");
    const modalImg        = document.getElementById("modalImg");
    const modalDesc       = document.getElementById("modalDesc");
    const modalPrice      = document.getElementById("modalPrice");
    const modalTouch      = document.getElementById("modalTouch");
    const modalDurability = document.getElementById("modalDurability");
    const modalFlight     = document.getElementById("modalFlight");
    const modalLook       = document.getElementById("modalLook");
    const closeModalBtn   = document.getElementById("closeModalBtn");

    // é—œé–‰æ¨è–¦ Modal
    closeModalBtn.addEventListener("click", () => {
      modalOverlay.style.display = "none";
      renderAllMatchingCards();
    });

    // æ¯æ¬¡æŠ€èƒ½æˆ–å·²èŠ±è²» (spent) æ›´æ–°ï¼Œéƒ½æª¢æŸ¥æ˜¯å¦è¦å½ˆæ¨è–¦ Modal
    function checkProductMatch() {
      for (let prod of products) {
        const matchSkill = (
          skills.touch >= prod.touch &&
          skills.durability >= prod.durability &&
          skills.flight >= prod.flight &&
          skills.look >= prod.look
        );
        // åªè¦ å·²èŠ±è²» (spent) >= å”®åƒ¹ï¼Œå°±é¡¯ç¤º
        const matchSpend = (spent >= prod.price);

        if (matchSkill && !hasShownModalFor.has(prod.name)) {
          hasShownModalFor.add(prod.name);
          modalName.textContent       = prod.name;
          modalImg.src                = prod.image;
          modalImg.alt                = prod.name;
          modalDesc.textContent       = prod.desc;
          modalPrice.textContent      = prod.price;
          modalTouch.textContent      = prod.touch;
          modalDurability.textContent = prod.durability;
          modalFlight.textContent     = prod.flight;
          modalLook.textContent       = prod.look;
          modalOverlay.style.display = "flex";
          return; // åªå…ˆå½ˆç¬¬ä¸€å€‹ç¬¦åˆæ¢ä»¶çš„æ¨è–¦
        }
      }
      // æ²’æœ‰æ–°çš„ã€Œé ˆå½ˆçª—ã€ç”¢å“ï¼Œå°±æ¸²æŸ“æ‰€æœ‰ç¬¦åˆã€ŒæŠ€èƒ½ æˆ– å·²èŠ±è²» â‰¥ åƒ¹æ ¼ã€çš„å¡ç‰‡
      renderAllMatchingCards();
    }

    // æ¸²æŸ“ä¸‹æ–¹ã€Œæ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„ç”¢å“å¡ç‰‡ã€
    function renderAllMatchingCards() {
      const p = document.getElementById("productDisplay");
      p.innerHTML = ""; // æ¸…ç©º

      products.forEach((prod) => {
        const matchSkill = (
          skills.touch >= prod.touch &&
          skills.durability >= prod.durability &&
          skills.flight >= prod.flight &&
          skills.look >= prod.look
        );
        const matchSpend = (spent >= prod.price);

        // å¡ç‰‡æ¢ä»¶ï¼šæŠ€èƒ½é–€æª»æˆ– å·²èŠ±è²» â‰¥ åƒ¹æ ¼ å…¶ä¸­ä¹‹ä¸€
        if (matchSkill || matchSpend) {
          const cardHtml = `
            <div class="product">
              <h3>ğŸ¯ æ¨è–¦çµ¦æ‚¨ï¼š${prod.name}</h3>
              <img src="${prod.image}" alt="${prod.name}">
              <p><strong>å•†å“åç¨±ï¼š</strong>KOMBO ${prod.name}</p>
              <p>${prod.desc}</p>
              <p><strong>å”®åƒ¹ï¼š</strong>$${prod.price}/ç­’</p>
              <p>
                æ‰‹æ„Ÿ Lv.${prod.touch} ï½œ 
                è€æ‰“ Lv.${prod.durability} ï½œ 
                é£›è¡Œ Lv.${prod.flight} ï½œ 
                å¤–è§€ Lv.${prod.look}
              </p>
              <a href="${prod.link}" target="_blank">å‰å¾€è³£å ´</a>
            </div>
          `;
          p.innerHTML += cardHtml;
        }
      });
    }

    // é¦–æ¬¡è¼‰å…¥ï¼šåˆå§‹åŒ–ç•«é¢
    window.addEventListener("DOMContentLoaded", () => {
      loadSaved();
      checkProductMatch();
    });
  </script>
</body>
</html>
