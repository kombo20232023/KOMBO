<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>KOMBO æŠ€èƒ½å¡æ¸¬è©¦</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background: #f9f9f9; margin: 20px; }
    .btn { padding: 10px 20px; background: orange; border: none; color: white; font-size: 16px; border-radius: 6px; margin: 10px; cursor: pointer; }
    .preview-container { margin-top: 20px; }
    #cardPreview img { border: 2px solid #ccc; border-radius: 8px; max-width: 100%; }
  </style>
</head>
<body>
  <h2>KOMBO æŠ€èƒ½å¡æ¸¬è©¦</h2>
  <button class="btn" onclick="generateSkillCard()">ç”¢ç”ŸæŠ€èƒ½å¡</button>
  <button class="btn" onclick="shareToInstagram()">ä¸‹è¼‰æŠ€èƒ½å¡</button>

  <div id="cardPreview" class="preview-container"></div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    function generateSkillCard() {
      const html = `
        <div id="cardArea" style="
          position: relative;
          width: 320px;
          aspect-ratio: 2/3;
          background: url('https://i.imgur.com/0ZzYz2X.png') no-repeat center center;
          background-size: cover;
          font-family: sans-serif;
          border: 2px solid #000;
        ">
          <div style="position: absolute; top: 20px; width: 100%; text-align: center; font-weight: bold; font-size: 24px;">XXXXXXXX</div>
          <div style="position: absolute; top: 60px; width: 100%; text-align: center; font-size: 18px;">ç¾½çƒæŠ€èƒ½å¡</div>
          <div style="position: absolute; bottom: 20px; width: 100%; text-align: center; font-size: 16px;">å”®åƒ¹ï¼š$450 å…ƒ</div>
        </div>
      `;

      const preview = document.getElementById('cardPreview');
      preview.innerHTML = '';
      const old = document.getElementById('hiddenCard');
      if (old) old.remove();

      const wrapper = document.createElement('div');
      wrapper.innerHTML = html;
      const cardElement = wrapper.firstElementChild;
      preview.appendChild(cardElement);

      const hidden = cardElement.cloneNode(true);
      hidden.id = 'hiddenCard';
      hidden.style.position = 'absolute';
      hidden.style.top = '-9999px';
      hidden.style.left = '-9999px';
      hidden.style.transform = 'none';
      hidden.style.transformOrigin = 'unset';
      document.body.appendChild(hidden);
    }

    function shareToInstagram() {
      setTimeout(() => {
        const tempCard = document.getElementById('hiddenCard');
        if (!tempCard) {
          alert("ä»ç„¶ç„¡æ³•å–å¾—æŠ€èƒ½å¡å…§å®¹ï¼Œè«‹ç¨å¾Œå†è©¦");
          return;
        }

        html2canvas(tempCard, {
          scale: 3,
          useCORS: true,
          backgroundColor: null
        }).then(canvas => {
          const imageUrl = canvas.toDataURL("image/png");
          const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

          if (isMobile) {
            document.getElementById("cardPreview").innerHTML = `
              <p><strong>ğŸ“¸ é•·æŒ‰åœ–ç‰‡å¯å„²å­˜å¾Œå†åˆ†äº«åˆ° IG</strong></p>
              <img src="${imageUrl}">
            `;
            alert("è«‹é•·æŒ‰åœ–ç‰‡å„²å­˜åˆ°ç›¸ç°¿ï¼Œå†åˆ†äº«è‡³ IG ğŸ§¡");
          } else {
            const link = document.createElement('a');
            link.download = 'KOMBO_æŠ€èƒ½å¡.png';
            link.href = imageUrl;
            link.click();
          }

          tempCard.remove();
        });
      }, 100);
    }
  </script>
</body>
</html>
