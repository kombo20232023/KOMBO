<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>KOMBO æŠ€èƒ½å‡ç´šæ¨¡æ“¬å™¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* ===== å…¨å±€æ¨£å¼ ===== */
    body {
      font-family: Arial, sans-serif;
      background-image: url('èƒŒæ™¯.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    .logo {
      width: 120px;
      margin: 10px auto;
      display: block;
    }
    .kcoin {
      font-size: 24px;
      color: #004080;
      margin-bottom: 20px;
    }

    /* ===== é–‹å ´ Intro Modal ===== */
    #introModal {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: white;
      z-index: 9999;
      padding: 30px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: left;
    }
    #introModal h2 {
      color: #f60;
      margin-bottom: 10px;
    }
    #introModal ol {
      margin-left: 20px;
    }
    #introModal a {
      color: #0066cc;
      font-weight: bold;
      text-decoration: underline;
    }
    #introModal button {
      background: #f60;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }

    /* ===== æŠ€èƒ½å‡ç´šå€ ===== */
    .skill-block {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 10px 0;
    }
    .skill-name {
      font-size: 18px;
      color: #004080;
      width: 30%;
      text-align: left;
    }
    .skill-level {
      font-size: 18px;
      width: 20%;
    }
    .btn-group {
      display: flex;
      gap: 5px;
      width: 50%;
      justify-content: flex-end;
    }
    /* å‡ç´šæŒ‰éˆ•ï¼šè—è‰² */
    .btn.upgrade {
      background: #FF7E00;
      color: white;
      border: none;
      padding: 8px;
      border-radius: 5px;
      cursor: pointer;
      width: 50%;
      font-size: 14px;
    }
    /* é™ç´šæŒ‰éˆ•ï¼šæ©˜è‰² */
    .btn.downgrade {
      background: #0066cc;
      color: white;
      border: none;
      padding: 8px;
      border-radius: 5px;
      cursor: pointer;
      width: 50%;
      font-size: 14px;
    }
    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    /* ===== ä¸‹æ–¹å·¥å…·æŒ‰éˆ• ===== */
    .tools {
      margin-top: 30px;
    }
    .tools button {
      margin: 0 8px;
      padding: 10px 18px;
      background: #0066cc;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }

    /* ===== Modal æ¨è–¦å¡ç‰‡å½ˆçª— ===== */
    .modal-overlay {
      display: none; /* JS æ§åˆ¶é¡¯ç¤ºæˆ–éš±è— */
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background-color: rgba(0,0,0,0.5);
      z-index: 9998;
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      max-width: 320px;
      width: 90%;
      padding: 20px;
      text-align: center;
      position: relative;
      animation: fadeInModal 0.3s ease-out;
    }
    @keyframes fadeInModal {
      from { opacity: 0; transform: translateY(-20px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .modal-content img {
      max-width: 80%;
      height: auto;
      margin-bottom: 12px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    .modal-content h3 {
      color: #D35400;
      margin-bottom: 8px;
      font-size: 18px;
    }
    .modal-content p {
      margin: 6px 0;
      line-height: 1.4;
      font-size: 14px;
      color: #333;
    }
    .modal-close-btn {
      margin-top: 12px;
      padding: 8px 16px;
      background: #0066CC;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }

    /* ===== ä¸‹æ–¹æ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„å¡ç‰‡ï¼šFlex å®¹å™¨ ===== */
    .product-recommend {
      margin-top: 40px;
      display: flex;
      flex-wrap: wrap;           /* è¶…å‡ºå¯¬åº¦æ™‚è‡ªå‹•æ›è¡Œ */
      justify-content: center;   /* å¡ç‰‡ç½®ä¸­å°é½Š */
      gap: 16px;                 /* å¡ç‰‡ä¹‹é–“çš„é–“è· */
      padding: 0 10px;
      box-sizing: border-box;
    }

    /* ===== å–®å¼µç”¢å“å¡ç‰‡æ¨£å¼ ===== */
    .product {
      background-color: #FFF8E1;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 15px;
      margin: 0;                    /* äº¤ç”±çˆ¶å®¹å™¨çš„ gap æ±ºå®šé–“è· */
      max-width: 300px;             /* å¡ç‰‡æœ€å¤§å¯¬åº¦ */
      width: 100%;                  /* åœ¨ Flex ä¸‹æœƒæ ¹æ“šçˆ¶å®¹å™¨ç©ºé–“èª¿æ•´ */
      flex: 1 1 280px;              /* æœ€å° 280px å¯¬åº¦ï¼Œç•«é¢å¯¬åº¦è¶³å¤ æ™‚å¯æ”¾å¤§ */
      text-align: center;
      animation: fadeIn 0.4s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .product img {
      display: block;
      margin: 0 auto 12px;
      max-width: 80%;
      height: auto;
      border-radius: 8px;
    }
    .product h3 {
      color: #D35400;
      margin-bottom: 8px;
      font-size: 18px;
    }
    .product p {
      margin: 6px 0;
      line-height: 1.4;
      font-size: 14px;
      color: #333;
    }
    .product a {
      display: inline-block;
      margin-top: 10px;
      padding: 10px 18px;
      background: linear-gradient(90deg, #FF7E00, #D35400);
      color: #fff;
      border: none;
      border-radius: 6px;
      text-decoration: none;
      font-size: 15px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.15);
      transition: opacity 0.2s;
    }
    .product a:hover {
      opacity: 0.9;
    }
  </style>
</head>
<body>

  <!-- ===== é–‹å ´å½ˆçª— ===== -->
  <div id="introModal">
    <div style="max-width:500px">
      <h2>ğŸ® KOMBO æŠ€èƒ½å‡ç´šæ¨¡æ“¬å™¨</h2>
      <p><strong>éŠç©å‰çš„æ³¨æ„äº‹é …ï¼š</strong></p>
      <ol style="margin-left:20px;">
        <li>æ­¤è©•åˆ†ç³»çµ±åƒ…ä¾›åƒè€ƒï¼Œç‚º KOMBO çš„å…§éƒ¨çµ±è¨ˆè³‡æ–™ï¼Œä¸ä»£è¡¨æ¯ä½çƒå‹çš„å¯¦éš›ä½¿ç”¨æ„Ÿå—ï¼Œè«‹å¸¶è‘—è¼•é¬†çš„å¿ƒæƒ…éŠç©ï¼</li>
        <li>æ‰€æœ‰åƒ¹æ ¼ç‚º <strong>2025.6.11</strong> çµ±è¨ˆä¹‹çµæœï¼Œè‹¥æœªä¾†æ¯›ç‰‡æˆæœ¬æˆ–å”®åƒ¹èª¿æ•´ï¼Œåˆå§‹é‡‘é¡ä¹Ÿæœƒæœ‰æ‰€è®Šå‹•ã€‚è‹¥å°ç·¨ä¾†ä¸åŠæ›´æ–°ï¼Œé‚„è«‹å¤§å®¶è¦‹è«’ï¼</li>
      </ol>
      <p>ğŸ“© æœ‰ä»»ä½•å»ºè­°æ­¡è¿åˆ°  
        <a href="https://www.instagram.com/kombo_2023?igsh=bGU4dGdia3F5NWM5&utm_source=qr" target="_blank">
          KOMBO IG
        </a> ç§è¨Šæˆ‘å€‘å–”ï¼
      </p>
      <div style="text-align:center; margin-top:20px;">
        <button onclick="startGame()">åŒæ„</button>
      </div>
    </div>
  </div>

  <!-- ===== LOGO & K å¹£ ===== -->
  <img src="LOGO.jpg" class="logo" alt="KOMBO Logo">
  <div class="kcoin">ç›®å‰å·²èŠ±è²» Kå¹£ï¼š<span id="kcoin">450</span></div>

  <!-- ===== æŠ€èƒ½å€ ===== -->
  <div class="skill-block">
    <div class="skill-name">æ‰‹æ„Ÿ</div>
    <div class="skill-level" id="lv-touch">Lv.1</div>
    <div class="btn-group">
      <button class="btn upgrade" id="up-touch" onclick="upgrade('touch')">å‡ç´šï¼ˆ+10 Kå¹£ï¼‰</button>
      <button class="btn downgrade" onclick="downgrade('touch')">é™ç´šï¼ˆ-10 Kå¹£ï¼‰</button>
    </div>
  </div>
  <div class="skill-block">
    <div class="skill-name">è€æ‰“</div>
    <div class="skill-level" id="lv-durability">Lv.1</div>
    <div class="btn-group">
      <button class="btn upgrade" id="up-durability" onclick="upgrade('durability')">å‡ç´šï¼ˆ+10 Kå¹£ï¼‰</button>
      <button class="btn downgrade" onclick="downgrade('durability')">é™ç´šï¼ˆ-10 Kå¹£ï¼‰</button>
    </div>
  </div>
  <div class="skill-block">
    <div class="skill-name">é£›è¡Œ</div>
    <div class="skill-level" id="lv-flight">Lv.1</div>
    <div class="btn-group">
      <button class="btn upgrade" id="up-flight" onclick="upgrade('flight')">å‡ç´šï¼ˆ+10 Kå¹£ï¼‰</button>
      <button class="btn downgrade" onclick="downgrade('flight')">é™ç´šï¼ˆ-10 Kå¹£ï¼‰</button>
    </div>
  </div>
  <div class="skill-block">
    <div class="skill-name">å¤–è§€</div>
    <div class="skill-level" id="lv-look">Lv.1</div>
    <div class="btn-group">
      <button class="btn upgrade" id="up-look" onclick="upgrade('look')">å‡ç´šï¼ˆ+10 Kå¹£ï¼‰</button>
      <button class="btn downgrade" onclick="downgrade('look')">é™ç´šï¼ˆ-10 Kå¹£ï¼‰</button>
    </div>
  </div>

  <!-- ===== å·¥å…·æŒ‰éˆ• ===== -->
  <div class="tools">
    <button onclick="shareToInstagram()">ğŸ“¸ åˆ†äº«è‡³ Instagram</button>
    <button onclick="resetAll()">ğŸ”„ é‡ç½®</button>
  </div>

  <!-- ===== Modal æ¨è–¦å½ˆçª— ===== -->
  <div class="modal-overlay" id="recommendModal">
    <div class="modal-content" id="modalContent">
      <h3>ğŸ¯ é©åˆä½ çš„çƒï¼š<span id="modalName"></span></h3>
      <img id="modalImg" src="" alt="ç”¢å“åœ–">
      <p id="modalDesc"></p>
      <p><strong>å”®åƒ¹ï¼š</strong>$<span id="modalPrice"></span>/ç­’</p>
      <p>
        æ‰‹æ„Ÿ Lv.<span id="modalTouch"></span> ï½œ 
        è€æ‰“ Lv.<span id="modalDurability"></span> ï½œ 
        é£›è¡Œ Lv.<span id="modalFlight"></span> ï½œ 
        å¤–è§€ Lv.<span id="modalLook"></span>
      </p>
      <button class="modal-close-btn" id="closeModalBtn">é—œé–‰</button>
    </div>
  </div>

  <!-- ===== ä¸‹æ–¹ç”¢å“å¡ç‰‡å€ ===== -->
  <div class="product-recommend" id="productDisplay">
    <!-- JS æœƒæŠŠæ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„ <div class="product">â€¦</div> å‹•æ…‹æ’å…¥åˆ°é€™è£¡ -->
  </div>

  <!-- ===== é»æ“ŠéŸ³æ•ˆ ===== -->
  <audio id="clickSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_f7998b6be6.mp3?filename=click-124467.mp3"></audio>

  <script>
    // ============== å…¨å±€ç‹€æ…‹ ==============
    let kcoin = 450;
    const maxLevel = 5;
    const skills = { touch: 1, durability: 1, flight: 1, look: 1 };
    const display = {
      touch: document.getElementById("lv-touch"),
      durability: document.getElementById("lv-durability"),
      flight: document.getElementById("lv-flight"),
      look: document.getElementById("lv-look")
    };
    let soundOn = true;

    // è¨˜éŒ„ã€Œå·²ç¶“å½ˆé Modal çš„ç”¢å“åç¨±ã€ï¼Œé¿å…é‡è¤‡å½ˆçª—
    let hasShownModalFor = new Set();

    // ===== ç”¢å“åˆ—è¡¨ï¼ˆç”±é«˜åƒ¹åˆ°ä½åƒ¹æ’åºï¼‰ =====
    const products = [
      {
        name: "K3A",
        price: 720,
        touch: 5,
        durability: 5,
        flight: 5,
        look: 4,
        image: "K3A.jpg",
        desc: "ä½¿ç”¨ä¸‰ã€å››ç´šéµæ¯›ï¼Œéµæ¯›æ¯›æ¡¿è¼ƒç‚ºç´°é•·ï¼Œå¤§æ¯›ä¸­çš„æ–¹é ­æ¯›å§‹æ–¼éŸŒæ€§é«˜ä¸”çµå¯¦ï¼æ­é…ä¸Šç‰¹èª¿çš„é«˜å›å¾©æ€§è† æ°´ï¼Œè®“çƒä¸å› æ‰“æ“Šè€Œé¬†æ•£ï¼",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K3",
        price: 720,
        touch: 5,
        durability: 5,
        flight: 4.5,
        look: 4.5,
        image: "K3.jpg",
        desc: "é¸ç”¨ä¸€ã€äºŒç´šåˆºéª¨é´¨æ½”ç™½æ¯›ç‰‡ï¼Œç‰¹é¸çš„éƒ¨ä½ï¼Œç‰¹é¸è† æ°´ï¼Œä½¿è€æ‰“åº¦æ›´ä¸Šä¸€éšï¼ŒåŒæ™‚å°‡çƒé ­çš„å¯†åº¦æå‡ï¼Œä½¿æ‰‹æ„Ÿæ›´åŠ æ‰å¯¦ï¼Œé£›è¡Œæ›´åŠ ç©©å®šã€‚",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K5+",
        price: 635,
        touch: 4,
        durability: 4,
        flight: 4,
        look: 4,
        image: "K5+.jpg",
        desc: "é¸ç”¨æ­£ä¸‰ç´šçš„åˆºéª¨é´¨ï¼Œç›¸è¼ƒæ–¼ä¸€äºŒç´šæ¯›ç‰‡è¼ƒé»ƒï¼Œç•¥æœ‰ç´°å¾®ç‘•ç–µï¼Œæ•´é«”å…¼å…·è€ç”¨è¡¨ç¾èˆ‡è¦ªæ°‘åƒ¹æ ¼ã€‚",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K5A",
        price: 630,
        touch: 4,
        durability: 4,
        flight: 3.5,
        look: 3,
        image: "K5A.jpg",
        desc: "ä½¿ç”¨å››ã€äº”ç´šéµæ¯›ï¼Œä»é¸ç”¨ç‰¹å®šçš„éƒ¨ä½ï¼Œè®“è³ªé‡èƒ½é”åˆ°ä¸€å®šçš„æ°´æº–ï¼Œæ­é…ä¸Šé«˜å½ˆæ€§çš„è† æ°´ï¼Œä½¿é£›è¡Œç©©å®šåˆå…¼é¡§å¥½çš„æ‰‹æ„Ÿï¼",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K5",
        price: 595,
        touch: 4,
        durability: 3.5,
        flight: 3.5,
        look: 2,
        image: "K5.jpg",
        desc: "é¸ç”¨æ¯›æ¡¿Qå½ˆã€ç¾½ç¿¼åšå¯¦çš„ä¸‰ã€å››ç´šåˆºéª¨é´¨ï¼Œæ­é…ç‰¹èª¿è† æ°´ï¼Œä½¿æ‰‹æ„Ÿèˆ’é©ä¸ç”Ÿç¡¬ï¼Œæ›´ä¸å®¹æ˜“æ–·æ¯›å¥½æ§åˆ¶ï¼Œç©©å®šé£›è¡Œï¼Œæ˜¯é«˜æ€§åƒ¹æ¯”çš„é¦–é¸ã€‚",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "KC",
        price: 560,
        touch: 4,
        durability: 3,
        flight: 4,
        look: 2,
        image: "KC.jpg",
        desc: "ä½¿ç”¨å¤©ç„¶äº”ç´šéµæ¯›ï¼Œé›–ç„¶æ¯›è‰²çš„æ•´æ½”åº¦ä¸æ˜¯ç²¾é¸ï¼Œä½†å…·æœ‰æ­£å¸¸éµæ¯›çš„ç©©å®šæ€§èˆ‡è€æ‰“åº¦ï¼Œæ­é…ä¸Šè¤‡åˆå¼è† æ°´ï¼Œæ‰“æ„Ÿèˆ’é©ï¼Œå¥½æ§çƒã€‚",
        link: "https://lin.ee/syEA7iU"
      },
      {
        name: "K7pro",
        price: 480,
        touch: 2,
        durability: 4,
        flight: 2,
        look: 2,
        image: "K7PRO.jpg",
        desc: "ä½¿ç”¨ä¸€ã€äºŒç´šéµå¤§åˆ€ï¼Œè‹¥èƒ½æ¥å—é£›è¡Œæ²’é‚£éº¼ç©©å®šçš„è©±ï¼Œå¯ä»¥è©¦è©¦é€™æ¬¾çƒã€‚",
        link: "https://lin.ee/syEA7iU"
      }
    ];

    // ============== éŸ³æ•ˆæ’­æ”¾ ==============
    function playSound() {
      if (soundOn) {
        document.getElementById("clickSound").play();
      }
    }

    // ============== å‡ç´šï¼é™ç´š ==============
    function upgrade(skill) {
      // å¦‚æœæŠ€èƒ½æœªæ»¿ä¸” K å¹£ â‰¥ 10ï¼Œå°±å¯å‡ 0.5 ç´šï¼ŒK å¹£ +10
      if (skills[skill] < maxLevel && kcoin >= 10) {
        skills[skill] += 0.5;
        kcoin += 10;
        playSound();
        updateDisplay(skill);
        saveState();
      }
    }
    function downgrade(skill) {
      if (skills[skill] > 1) {
        skills[skill] -= 0.5;
        kcoin -= 10;
        playSound();
        updateDisplay(skill);
        saveState();
      }
    }

    // ============== æ›´æ–°ç•«é¢é¡¯ç¤º ==============
    function updateDisplay(skill) {
      // æ›´æ–° K å¹£æ•¸å­—
      document.getElementById("kcoin").textContent = kcoin;
      // æ›´æ–°å–®ä¸€æŠ€èƒ½çš„ç­‰ç´šæ–‡å­—
      display[skill].textContent = (skills[skill] >= maxLevel) ? "å·²æ»¿ç­‰" : ("Lv." + skills[skill]);
      // å¦‚æœè©²æŠ€èƒ½å·²æ»¿æˆ– K å¹£ä¸è¶³ 10ï¼Œå°±ç¦ç”¨å°æ‡‰çš„ã€Œå‡ç´šã€æŒ‰éˆ•
      document.getElementById("up-" + skill).disabled = (skills[skill] >= maxLevel || kcoin < 10);
      // æ¯æ¬¡æ›´æ–°éƒ½å˜—è©¦è§¸ç™¼ Modal æˆ–æ¸²æŸ“ä¸‹æ–¹å¡ç‰‡
      checkProductMatch();
    }

    // ============== åˆ†äº«è‡³ Instagramï¼ˆæˆ–è¤‡è£½è‡³å‰ªè²¼ç°¿ï¼‰ ==============
    function shareToInstagram() {
      // æº–å‚™è¦åˆ†äº«çš„æ–‡å­—
      const shareText = `æˆ‘åœ¨ KOMBO å‡ç´šæ¨¡æ“¬å™¨ä¸­é»å‡ºäº†ï¼š\næ‰‹æ„Ÿ Lv.${skills.touch}ã€è€æ‰“ Lv.${skills.durability}ã€é£›è¡Œ Lv.${skills.flight}ã€å¤–è§€ Lv.${skills.look}\nç¸½å…±èŠ±è²»ï¼š${kcoin} K å¹£ï¼`;
      // å¦‚æœç€è¦½å™¨æ”¯æ´ Web Share APIï¼Œå°±ç›´æ¥å‘¼å«
      if (navigator.share) {
        navigator.share({
          title: "KOMBO æŠ€èƒ½å‡ç´šæ¨¡æ“¬å™¨",
          text: shareText
        }).catch((err) => {
          // å¦‚æœä½¿ç”¨è€…å–æ¶ˆåˆ†äº«æˆ–ç™¼ç”ŸéŒ¯èª¤ï¼Œå°± fallback è¤‡è£½
          copyFallback();
        });
      } else {
        // ä¸æ”¯æ´ Web Shareï¼Œå°± fallback è¤‡è£½æ–‡å­—åˆ°å‰ªè²¼ç°¿
        copyFallback();
      }

      // Fallback çš„å‡½å¼ï¼šæŠŠ shareText è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼Œä¸¦è·³å‡ºæç¤º
      function copyFallback() {
        navigator.clipboard.writeText(shareText).then(() => {
          alert("å·²è¤‡è£½åˆ†äº«æ–‡å­—åˆ°å‰ªè²¼ç°¿ï¼Œè«‹è²¼åˆ° Instagram åˆ†äº« ğŸ˜Š");
        }).catch(() => {
          alert("ç„¡æ³•è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼Œè«‹æ‰‹å‹•å°‡ä»¥ä¸‹æ–‡å­—è¤‡è£½ä¸¦è²¼è‡³ Instagramï¼š\n\n" + shareText);
        });
      }
    }

    // ============== é‡æ–°è¨­å®š & å­˜ / è¼‰ æœ¬åœ°åŒ–ç‹€æ…‹ ==============
    function saveState() {
      localStorage.setItem("kombo_skills", JSON.stringify({ kcoin, skills }));
    }
    function loadSaved() {
      // æ¸…ç©º localStorageï¼Œå›åˆ°åˆå§‹ç‹€æ…‹
      localStorage.removeItem("kombo_skills");
      kcoin = 450;
      skills.touch = skills.durability = skills.flight = skills.look = 1;
      for (let key in skills) {
        updateDisplay(key);
      }
      hasShownModalFor.clear(); // æ¸…é™¤æ›¾ç¶“å½ˆéçš„ç”¢å“è¨˜éŒ„
    }

    // â–¶ **æ–°å¢ resetAll()ï¼šæŒ‰ä¸‹é‡ç½®æ™‚å‘¼å« loadSaved()ï¼ˆä¸¦é †ä¾¿é—œé–‰ Modalï¼‰**
    function resetAll() {
      loadSaved();
      // å¦‚æœ Modal é‚„åœ¨é–‹ï¼Œå°±å…ˆé—œé–‰
      const modalOverlay = document.getElementById("recommendModal");
      modalOverlay.style.display = "none";
      // é‡æ–°æ¸²æŸ“ä¸€ä¸‹ä¸‹æ–¹å¡ç‰‡
      renderAllMatchingCards();
    }

    // ============== é»æ“Šã€Œé–‹å§‹éŠæˆ²ã€æŒ‰éˆ•å¾Œï¼Œéš±è—å½ˆçª— ==============
    function startGame() {
      alert("é€™æ˜¯ä¸€å ´æŠ€èƒ½çš„è©¦ç…‰â€”â€”å‡ºç™¼å§ï¼ŒKå¤§å¸«ï¼");
      document.getElementById("introModal").style.display = "none";
      loadSaved();
    }

    // ============== Modal å½ˆçª—èˆ‡ä¸‹æ–¹å¡ç‰‡é‚è¼¯ ==============
    const modalOverlay    = document.getElementById("recommendModal");
    const modalName       = document.getElementById("modalName");
    const modalImg        = document.getElementById("modalImg");
    const modalDesc       = document.getElementById("modalDesc");
    const modalPrice      = document.getElementById("modalPrice");
    const modalTouch      = document.getElementById("modalTouch");
    const modalDurability = document.getElementById("modalDurability");
    const modalFlight     = document.getElementById("modalFlight");
    const modalLook       = document.getElementById("modalLook");
    const closeModalBtn   = document.getElementById("closeModalBtn");

    // é»æ“Šã€Œé—œé–‰ Modalã€å¾Œï¼Œéš±è—ï¼Œä½†åŒæ™‚æŠŠä¸‹æ–¹å¡ç‰‡å…¨éƒ¨æ¸²æŸ“å‡ºä¾†
    closeModalBtn.addEventListener("click", () => {
      modalOverlay.style.display = "none";
      renderAllMatchingCards();
    });

    // æ¯æ¬¡æŠ€èƒ½æˆ– K å¹£æ›´æ–°ï¼Œéƒ½å‘¼å«æ­¤å‡½å¼ä¾†æª¢æŸ¥æ˜¯å¦è¦å½ˆ Modal
    function checkProductMatch() {
      // åªä»¥ã€ŒæŠ€èƒ½æ¢ä»¶ç¬¦åˆã€ä¾†æ±ºå®šæ˜¯å¦å½ˆçª—
      for (let prod of products) {
        const matchSkill = (
          skills.touch >= prod.touch &&
          skills.durability >= prod.durability &&
          skills.flight >= prod.flight &&
          skills.look >= prod.look
        );
        if (matchSkill && !hasShownModalFor.has(prod.name)) {
          // æ¨™è¨˜æ­¤ç”¢å“å·²ç¶“å½ˆéä¸€æ¬¡ Modalï¼Œä¸è¦å†é‡è¤‡å½ˆ
          hasShownModalFor.add(prod.name);

          // å¡«å…¥ Modal å…§å®¹
          modalName.textContent       = prod.name;
          modalImg.src                = prod.image;
          modalImg.alt                = prod.name;
          modalDesc.textContent       = prod.desc;
          modalPrice.textContent      = prod.price;
          modalTouch.textContent      = prod.touch;
          modalDurability.textContent = prod.durability;
          modalFlight.textContent     = prod.flight;
          modalLook.textContent       = prod.look;

          // é¡¯ç¤ºé®ç½© + å½ˆçª—
          modalOverlay.style.display = "flex";
          return; // åªå½ˆç¬¬ä¸€å€‹ç¬¦åˆæŠ€èƒ½æ¢ä»¶çš„ç”¢å“
        }
      }

      // æ²’æœ‰æ–°çš„ã€Œé ˆå½ˆçª—ã€ç”¢å“ï¼Œå°±æ¸²æŸ“æ‰€æœ‰ç¬¦åˆã€ŒæŠ€èƒ½ æˆ– åƒ¹æ ¼ã€æ¢ä»¶çš„å¡ç‰‡
      renderAllMatchingCards();
    }

    // æ¸²æŸ“ä¸‹æ–¹ã€Œæ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„ç”¢å“å¡ç‰‡ã€
    function renderAllMatchingCards() {
      const p = document.getElementById("productDisplay");
      p.innerHTML = ""; // æ¸…ç©º

      products.forEach((prod) => {
        const matchSkill = (
          skills.touch >= prod.touch &&
          skills.durability >= prod.durability &&
          skills.flight >= prod.flight &&
          skills.look >= prod.look
        );
        const matchPrice = (kcoin >= prod.price);

        // ä¸‹æ–¹å¡ç‰‡ä¾ç„¶ä¿ç•™ã€ŒæŠ€èƒ½é–€æª»æˆ–åƒ¹æ ¼é–€æª»ã€å…¶ä¸­ä¹‹ä¸€å³å¯é¡¯ç¤º
        if (matchSkill || matchPrice) {
          const cardHtml = `
            <div class="product">
              <h3>ğŸ¯ é©åˆä½ çš„çƒï¼š${prod.name}</h3>
              <img src="${prod.image}" alt="${prod.name}">
              <p><strong>å•†å“åç¨±ï¼š</strong>KOMBO ${prod.name}</p>
              <p>${prod.desc}</p>
              <p><strong>å”®åƒ¹ï¼š</strong>$${prod.price}/ç­’</p>
              <p>
                æ‰‹æ„Ÿ Lv.${prod.touch} ï½œ 
                è€æ‰“ Lv.${prod.durability} ï½œ 
                é£›è¡Œ Lv.${prod.flight} ï½œ 
                å¤–è§€ Lv.${prod.look}
              </p>
              <a href="${prod.link}" target="_blank">å‰å¾€è³£å ´</a>
            </div>
          `;
          p.innerHTML += cardHtml;
        }
      });
    }

    // ç•«é¢ç¬¬ä¸€æ¬¡è¼‰å…¥æ™‚ï¼Œå…ˆæŠŠç‹€æ…‹åˆå§‹åŒ–ï¼Œå†æª¢æŸ¥æ˜¯å¦è¦å½ˆ Modal / æ¸²æŸ“å¡ç‰‡
    window.addEventListener("DOMContentLoaded", () => {
      loadSaved();
      checkProductMatch();
    });
  </script>
</body>
</html>
